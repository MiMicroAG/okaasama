# Google Calendar API 設定手順

カレンダー画像から「田」文字を検出してGoogleカレンダーに自動登録するシステムを使用するには、Google Calendar APIの設定が必要です。

## 1. Google Cloud Console での設定

### 1.1 プロジェクトの作成
1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. 新しいプロジェクトを作成するか、既存のプロジェクトを選択

### 1.2 Google Calendar API の有効化
1. 左側のメニューから「APIとサービス」→「ライブラリ」を選択
2. 「Google Calendar API」を検索して選択
3. 「有効にする」をクリック

### 1.3 OAuth 同意画面の設定
1. 「APIとサービス」→「OAuth同意画面」を選択
2. ユーザータイプで「外部」を選択（個人使用の場合）
3. 必要な情報を入力：
   - アプリ名: 「カレンダー自動登録システム」
   - ユーザーサポートメール: あなたのメールアドレス
   - デベロッパーの連絡先情報: あなたのメールアドレス

### 1.4 認証情報の作成
1. 「APIとサービス」→「認証情報」を選択
2. 「認証情報を作成」→「OAuth クライアント ID」をクリック
3. アプリケーションの種類で「デスクトップアプリケーション」を選択
4. 名前を入力（例：「カレンダー登録アプリ」）
5. 「作成」をクリック
6. 作成された認証情報のJSONファイルをダウンロード
7. ダウンロードしたファイルを `credentials.json` という名前で保存

## 2. システムの使用方法

### 2.1 認証情報の配置
```bash
# credentials.jsonを作業ディレクトリに配置
cp /path/to/downloaded/credentials.json /home/ubuntu/credentials.json
```

### 2.2 カレンダー画像の解析と登録
```bash
# 1. AI画像認識で「田」文字を検出
python3 ai_calendar_analyzer.py

# 2. Googleカレンダーにスケジュールを登録
python3 google_calendar_manager.py
```

### 2.3 統合ワークフロー（一括実行）
```bash
# 画像解析からカレンダー登録まで一括実行
python3 integrated_workflow.py /path/to/calendar_image.jpg
```

## 3. 初回認証について

初回実行時には以下の手順で認証を行います：

1. ブラウザが自動的に開きます
2. Googleアカウントでログイン
3. アプリケーションへのアクセス許可を承認
4. 認証が完了すると `token.json` ファイルが作成されます
5. 次回以降は自動的に認証されます

## 4. トラブルシューティング

### エラー: 認証情報ファイルが見つかりません
- `credentials.json` ファイルが正しい場所に配置されているか確認
- ファイル名が正確か確認（大文字小文字も含む）

### エラー: API が有効になっていません
- Google Cloud Console で Google Calendar API が有効になっているか確認

### エラー: 権限が不足しています
- OAuth 同意画面の設定が完了しているか確認
- 必要なスコープ（calendar）が設定されているか確認

## 5. セキュリティについて

- `credentials.json` と `token.json` は機密情報です
- これらのファイルを他人と共有しないでください
- 不要になった場合は削除してください
- 定期的にアクセス権限を見直してください

## 6. システムの機能

### 6.1 AI画像認識機能
- カレンダー画像から「田」文字を自動検出
- 手書き文字にも対応
- 確信度付きで結果を出力

### 6.2 Google Calendar連携機能
- 終日イベントとして「母出勤」を登録
- リマインダーなしで設定
- 重複チェック機能付き
- 複数日付の一括登録

### 6.3 統合ワークフロー
- 画像アップロードから登録完了まで自動化
- エラーハンドリング機能
- 詳細なログ出力

